import os
import google.generativeai as genai
import socket
from dotenv import load_dotenv
load_dotenv()
genai.configure(api_key=os.environ["GEMINI_API_KEY"])

# Create the model
generation_config = {
  "temperature": 1,
  "top_p": 0.95,
  "top_k": 64,
  "max_output_tokens": 8192,
  "response_mime_type": "text/plain",
}

model = genai.GenerativeModel(
  model_name="learnlm-1.5-pro-experimental",
  generation_config=generation_config,
)

chat_session = model.start_chat(
  history=[
    {
      "role": "user",
      "parts": [
        "Suppose you are an hr of a company. You have a simple job. When a resume data is given to you, identify what skills the candidate possesses, including all sorts of skills (technical skills, problem solving skills, communication, leadership, soft skill, anything), how many years of experience he has, and then finally pose 10 questions for him, which he has to answer. you will evaluate the answers and give an evaluation of the candidate, such as : Has good coding skills, but lacks in communication. Only give questions as output, no unnecessary lines such as 'Here are 10 questions'. and your evaluation of those question's answers as output, nothing unnecessary. Follow this format in conversations:\n\nUser: {CV data}\nYou: {questions depending on cv skills and experience}\nUser: {Answers}\nYou: {return evaluation}\"\"\"",
      ],
    },
    {
      "role": "model",
      "parts": [
        "Okay, I'm ready. Please provide the CV data.  \n",
      ],
    },
    {
      "role": "user",
      "parts": [
        " Executive Profile\n Senior Software Executive Senior Software Executive who is a key contributor to strategic planning and product development. Highly skiled at\n creating and implementing key software improvements and process changes by uncovering major process limitations, maximizing profitability,\n scalability, and competition in the global marketplace. Accomplishments (over last 15 years +) Reported directly to C-level executives and Board\n members, successfuly bridging the gap between the business and Engineering, implementing strategic plans and ensuring that the engineering teams\n are aligned to business goals. Agile expert and evangelist, running software development teams for over 17 years and specificaly agile software\n development for more that 13 years. Reorganized and transitioned many teams and companies to become smooth running agile groups, drasticaly\n reducing delivery issues, making the work very transparent, empowering team members to become self-directed and accountable to their\n commitments. Skiled at managing entire software development process and employees including QA, Project Management, Technical Support, on\n and o fshore teams, contractors, subsidiaries, and merger/acquisitions. Successfuly on-boarded the engineers and technology from an acquired\n company and quickly merged their intelectual property (IP) into the main product line. Advocate for strong Engineering Best Practices, including\n design & code reviews, paired programming, unit tests and continuous integration testing through automation. Including, establishing leading and\n trailing engineering metrics, which provide strong indicators of product quality and delivery schedule. Managed globaly distributed teams ranging\n from 15-60 people, with P&L responsibilities between $2M - $6M. Teams have been located in US, Germany, Hungary, Russia, China, and\n Argentina. Consistently an early adopter of critical trends in methodologies and practices, which transform and refine processes to increase the\n delivery of business value.\n Skil Highlights\n Technology Â· Java Â· Amazon AWS Â· Hibernate Â· PHP Â· EC2 Â· Elastic Search Â· C++ Â· JSMVC Â· JUnit Â· C Â· HTML Â·\n Selenium Â· CanJS Â· CSS Â· Aurora Â· PL/SQL Â· Bootstrap Â· Jenkins Â· Oracle Â· Python Â· Phabricator Â· My/SQL Â· AJAX Â·\n GitHub Â· JavaScript Â· Camel Â· Jira Â· REST and SOAP services Â· MongoDB Â· Perl\n Professional Experience\n Engineering Operations Director \nJanuary 2014 to Current Company Name ï¼ City , State\n A high growth company, whose suite of services help researchers successfuly communicate their work.\n Identified misalignment between technical teams and business, reorganized the technical teams and aligned technical metrics to support\n business KPIs, increasing revenue and cost savings.\n Doubled team to 20 people in 4 months, by introducing a new improved hiring process that quickly filtered out non-qualified candidates and\n increased our acceptance rate to over 90%.\n Awarded Culture Champion Award.\n Director of Software Development \nJanuary 2012 to January 2014 Company Name ï¼ City , State\n A non-profit organization devoted to the advancement and wel-being of dogs.\n Turned around a multiyear software delivery failure, by re-architecting the approach taken, changing the technology used, and transitioning\n the team to Agile; puting the software back on budget and on time.\n Reduced technical dependency on old technologies by road mapping out a multiyear strategic technology plan, reducing number of\n technologies used throughout the department by 50%.\n Responsible for web based PCI compliant e-commerce software, connected to an enterprise database.\n Chief Operating O ficer \nJanuary 2010 to January 2012 Company Name ï¼ City , State\n Public safety software and services company focused on enterprise-class software for Fire and EMS Departments.\n Implemented a SaaS solution, alowing smaler towns and cities the ability to use and integrate with the Fire and EMS software.\n Reduced customer's server upgrade time from 4 days to 4 hours.\n Removed the requirement, caused by software limitations, that hard mounted mobile computers be removed from fire trucks and brought\n into the IT dept for upgrades.\n Reduced a mobile computer's instal and upgrade times from 1 day per machine to 2 hours.\n Vice President of Engineering \nJanuary 2001 to January 2010 Company Name ï¼ City , State\n A mid-sized 3D software company for creating digital models of physical objects, including both 'o f-the-shelf' and customized commercial\n applications.\n The software is used globaly in markets such as: rapid prototyping, reverse engineering, inspection, and healthcare.\n Grew revenue from $0 to over $16M with a CAGR greater than 30% for 6 consecutive years.\n Integral in receiving 6 term sheets of similar valuation resulting in $8M in VC funds in 2008.\n Expanded company organicaly from 22 to 110 employees, coordinated e fectively with Sales, Product Development, and Marketing teams\n to produce globaly competitive products.\n Conceived of and implemented critical changes in software architectural designs creating a partner eco- system.\n Director of Software Development \nJanuary 2000 to January 2001 Company Name ï¼ City , State\nA 30 person company using its patented lens system to project a standard 3D image into a 180 degree.\n hemispherical screen using software to convert the flat image to the curved surface without distortion.\n Engineering Manager/Senior Software Engineer \nJanuary 1996 to January 2000 Company Name ï¼ City , State\n A 60 person company providing B2B and B2C real-time 3D solutions, via the Internet.\n Software Engineer \nJanuary 1993 to January 1996 Company Name ï¼ City , State\n Software Engineer \nJanuary 1989 to January 1993 Company Name ï¼ City , State\n Education\n Postgraduate courses in Cognitive and Neural Systems : 1991 Boston University ï¼ City , State\n M. S : Computer Science , 1989 Union Colege ï¼ City , State Computer Science Masters Project: A Netless Neural Network - presented on\n August 16, 1989 at International Conference on Expert Systems and Neural Networks - Theory & Applications\n B. S : Computer Science , 1988 Union Colege ï¼ City , State Computer Science\n Skils\n 3D, Agile, AJAX, approach, B2B, budget, C, C++, competitive, CSS, database, delivery, e-commerce, Expert Systems, funds, hiring, HTML,\n PHP, image, inspection, Java, JavaScript, Marketing, MongoDB, enterprise, Network, Networks, Neural, Oracle, PL/SQL, PCI, Perl, Product\n Development, profit, prototyping, Public safety, Python, real-time 3, receiving 6, requirement, Sales, SOAP, SQL, strategic, upgrades, upgrade,\n valuation, V",
      ],
    },
    {
      "role": "model",
      "parts": [
        "1.  Tell me about a time you had to turn around a failing software project. What was the situation, what actions did you take, and what was the outcome?\n2.  Describe your experience with Agile methodologies. What specific Agile frameworks have you used, and how have you successfully implemented them in your teams?\n3.  How do you approach building and managing high-performing software development teams? What strategies do you use to motivate and empower your team members?\n4.  Give an example of a time when you had to make a difficult technical decision with limited information. How did you approach the problem, and what was the result?\n5.  Explain your experience with cloud computing platforms, particularly AWS. What services have you used, and how have they benefited your projects?\n6.  How do you stay up-to-date with the latest technologies and trends in software development?\n7.  Describe your experience with managing geographically distributed teams. What challenges have you faced, and how have you overcome them?\n8.  Tell me about a time when you had to communicate complex technical information to non-technical stakeholders. How did you ensure clear and effective communication?\n9.  How do you prioritize and manage multiple projects simultaneously? What tools and techniques do you use to stay organized and on track?\n10.  What are your salary expectations for this role?\n\n\n\n",
      ],
    },
    {
      "role": "user",
      "parts": [
        "1. Tell me about a time you had to turn around a failing software project. What was the situation, what actions did you take, and what was the outcome?\n\n\"In a previous role, we were developing a critical e-commerce platform that was significantly behind schedule and plagued with performance issues. The original team had underestimated the complexity of integrating legacy systems and hadn't established clear communication channels. The project was at risk of being scrapped.\n\nI stepped in as the lead, and my first action was to conduct a thorough audit of the codebase and project documentation. We identified key bottlenecks and areas of technical debt. I then facilitated a series of workshops with the development team, product owners, and stakeholders to re-establish trust and realign on project goals. We implemented a daily stand-up routine to improve communication and track progress. We broke down the project into smaller, manageable sprints, focusing on delivering incremental value. We also introduced automated testing and continuous integration to improve code quality and reduce bugs.\n\nThe outcome was a successful launch of the platform, albeit a few weeks behind the revised schedule. We significantly improved performance, reduced bug rates, and restored stakeholder confidence. The key was a combination of technical restructuring, improved communication, and a focus on delivering value in small, iterative steps.\"\n\n2. Describe your experience with Agile methodologies. What specific Agile frameworks have you used, and how have you successfully implemented them in your teams?\n\n\"I'm a strong advocate for Agile methodologies and have extensive experience implementing them in various software development teams. I've primarily worked with Scrum and Kanban frameworks.\n\nIn my previous role, I led teams using Scrum. We established clear sprint goals, held daily stand-ups, conducted sprint planning and retrospectives, and maintained a well-groomed product backlog. I've also successfully implemented Kanban for continuous delivery, particularly for maintenance and support projects, using visual boards to track workflow and limit work in progress.\n\nI've found that the key to successful Agile implementation is to tailor the framework to the specific needs of the team and project. It's also vital to foster a culture of collaboration, transparency, and continuous improvement.\"\n\n3. How do you approach building and managing high-performing software development teams? What strategies do you use to motivate and empower your team members?\n\n\"Building a high-performing team starts with recruiting individuals with strong technical skills and a collaborative mindset. I believe in fostering a culture of trust, open communication, and continuous learning.\n\nTo motivate and empower team members, I focus on:\n\nClear Goals and Ownership: Defining clear goals and giving team members ownership of their tasks.\nProviding Growth Opportunities: Encouraging learning through mentorship, training, and challenging projects.\nRecognizing and Rewarding Contributions: Celebrating successes and acknowledging individual contributions.\nCreating a Safe and Supportive Environment: Fostering a culture where team members feel comfortable sharing ideas and concerns.\nEmpowering Decision-Making: Giving team members autonomy to make technical decisions.\nI believe in servant leadership, where my role is to remove obstacles and support the team in achieving their goals.\"\n\n4. Give an example of a time when you had to make a difficult technical decision with limited information. How did you approach the problem, and what was the result?\n\n\"We were developing a real-time data processing system, and we faced a critical decision regarding the choice of a messaging queue. We had limited time to evaluate different options, and there was no clear consensus on the best solution.\n\nI approached the problem by:\n\nRapidly researching the available options and their key features.\nConducting a short proof-of-concept with the most promising candidates.\nConsulting with experienced engineers to gather their insights.\nAnalyzing the trade-offs between performance, scalability, and cost.\nBased on this analysis, we chose Apache Kafka. Although it required a steeper learning curve, it offered the best long-term scalability and performance for our needs. The decision proved to be successful, as the system handled increasing data volumes without performance degradation.\"\n\n5. Explain your experience with cloud computing platforms, particularly AWS. What services have you used, and how have they benefited your projects?\n\n\"I have extensive experience with AWS, having used it to deploy and manage various applications. I've worked with services like:\n\nEC2: For scalable compute instances.\nS3: For object storage and data backup.   \nRDS: For managed relational databases.\nLambda: For serverless computing.   \nCloudFormation: For infrastructure as code.\nAPI Gateway: For building and managing APIs.\nThese services have significantly benefited my projects by:\n\nImproving scalability and reliability.\nReducing infrastructure costs.\nAccelerating development cycles.\nEnabling rapid prototyping and deployment.\"\n6. How do you stay up-to-date with the latest technologies and trends in software development?\n\n\"I'm a firm believer in continuous learning. I stay up-to-date by:\n\nReading industry blogs, articles, and books.\nAttending conferences and webinars.\nParticipating in online communities and forums.\nExperimenting with new technologies in personal projects.\nFollowing thought leaders on social media.\"\n7. Describe your experience with managing geographically distributed teams. What challenges have you faced, and how have you overcome them?\n\n\"I've managed teams distributed across multiple time zones. The main challenges are communication barriers and cultural differences.\n\nTo overcome these, I've:\n\nEstablished clear communication protocols and tools.\nScheduled regular video conferences to foster face-to-face interaction.\nUsed collaborative tools for project management and documentation.\nPromoted cultural sensitivity and understanding.\nEncouraged regular team building activities.\nThe key is to create a sense of shared purpose and build strong relationships.\"\n\n8. Tell me about a time when you had to communicate complex technical information to non-technical stakeholders. How did you ensure clear and effective communication?\n\n\"When presenting a new system architecture to non-technical stakeholders, I focused on:\n\nUsing analogies and metaphors to explain complex concepts.\nVisual aids like diagrams and flowcharts.\nFocusing on the business value and benefits.\nAvoiding technical jargon.\nProviding opportunities for questions and feedback.\nI also prepared a concise executive summary that highlighted the key takeaways.\"\n\n9. How do you prioritize and manage multiple projects simultaneously? What tools and techniques do you use to stay organized and on track?\n\n\"I prioritize based on impact, urgency, and dependencies. I use:\n\nProject management tools like Jira or Asana.\nTime management techniques like the Eisenhower Matrix.\nRegular status meetings and progress reports.\nClear communication with stakeholders.\nBreaking down large projects into smaller, manageable tasks.\nI also believe in delegation and empowering team members to take ownership.\"\n\n10. What are your salary expectations for this role?\n\n\"Based on my experience and research of similar roles in this area, I'm looking for a salary in the range of [Your Desired Range]. However, I'm open to discussing this further and considering the overall compensation package.\"",
      ],
    },
    {
      "role": "model",
      "parts": [
        "## Evaluation:\n\n* **Strong Technical Skills:**  The candidate demonstrates a deep understanding of various technologies and methodologies, including Agile, cloud computing (AWS), and software development best practices. \n* **Leadership and Management:** The candidate showcases experience leading and managing teams, fostering collaboration, and driving successful project outcomes. They highlight their ability to motivate, empower, and build high-performing teams.\n* **Problem-Solving and Decision-Making:** The candidate provides concrete examples of tackling complex technical challenges with limited information, demonstrating analytical and decision-making skills.\n* **Communication Skills:** While the candidate demonstrates strong technical communication, there's room for improvement in conveying complex information to non-technical audiences. The examples provided could be strengthened by highlighting specific strategies used to ensure clarity and understanding.\n* **Negotiation Skills:** The candidate provides a clear and reasonable salary expectation range, demonstrating preparedness and professionalism.\n\n\n**Overall:** This candidate appears to be a strong fit for a senior software development role. Their technical expertise, leadership experience, and problem-solving abilities are impressive.  Further assessment of their communication skills, particularly in non-technical contexts, would be beneficial. \n",
      ],
    },
  ]
)


def llm_api_call(user_input,response=''):
    response = chat_session.send_message(user_input)
    return (response.text)